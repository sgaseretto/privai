---

title: Differential Privacy

keywords: fastai
sidebar: home_sidebar

summary: "Como realizar analisis estadisticos sobre datos sin comprometer la privacidad de los mismos"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/01-differential-privacy.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Qu&#233;-es-Differential-Privacy">Qu&#233; es Differential Privacy<a class="anchor-link" href="#Qu&#233;-es-Differential-Privacy">&#182;</a></h2><p>Differential Privacy o Privacidad Diferencial busca que podamos realizar analisis estadisticos sobre datos sin violar la privacidad de las personas que puedan existir dentro de ese dataset. Primero tenemos que explicar cuando estamos conservando la privacidad de un usuario.</p>
<p>Podemos decir que estamos <strong>preservando la privacidad</strong> de un grupo de personas cuando después de un análisis, el analizador no sabe nada sobre las personas en el dataset, estos permanecen sin ser "observados".</p>
<p>Cynthia Dwork, pionera en el campo de privacidad diferencial, define <code>Differential Privacy</code> de de la siguiente manera</p>
<blockquote><p>Differential Privacy describe una promesa, hecha por el individuo que utilizará los datos, al individuo que provee los datos, y la promesa es: &gt;&gt;"No se verá afectado, de manera adversa o de otro modo, al permitir que sus datos sean utilizados en cualquier estudio o analysis, sin importar qué otros estudios, conjuntos de datos, o fuentes de información hay disponibles"</p>
</blockquote>
<h2 id="Anonimizar-datos-no-es-suficiente">Anonimizar datos no es suficiente<a class="anchor-link" href="#Anonimizar-datos-no-es-suficiente">&#182;</a></h2><p>Si tenemos un dataset anonimizada, y otro grupo libera un dataset relacionado también anonimizado, muchas veces es posible combinar estos datasets y lograr desanonimizar los datos. Esto fue demostrado con varios ejemplos, como el uso de datasets omo IMDB para desanonimizar usuarios de MovieLens.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Differential-Privacy-en-una-base-de-datos-de-juguete">Differential Privacy en una base de datos de juguete<a class="anchor-link" href="#Differential-Privacy-en-una-base-de-datos-de-juguete">&#182;</a></h2><p>Simulemos que tenemos una base de datos de 5000 usuarios, donde solo tenemos una columna que almacena unos y ceros. Podemos suponer que si esta base de datos fuera una sobre pacientes de cancer, cuando una fila tienen un 1 supongamos que el paciente tiene cancer y 0 cuando no lo tiene.</p>
<p>Si removemos una persona de las 5000 podemos estar seguros de que la información de dicho paciente no se filtró. Entonces, es posible realizar una consulta que no cambie sin importar a quien removamos de la base de datos?</p>
<h2 id="Primero-creamos-la-Base-de-Datos">Primero creamos la Base de Datos<a class="anchor-link" href="#Primero-creamos-la-Base-de-Datos">&#182;</a></h2><p>Inicializamos una lizta randomica de 1s y 0s donde cada entrada se corresponde directamente con el numero de personas en la base de datos</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Numero de entradas en DB</span>
<span class="n">num_entries</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">db</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([ True, False,  True,  ...,  True,  True, False])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generar-Based-de-Datos-Paralelas">Generar Based de Datos Paralelas<a class="anchor-link" href="#Generar-Based-de-Datos-Paralelas">&#182;</a></h2><p>Clave para la definicion de <code>Differential privacy</code> es la habilidad de preguntar "Cuando consultando una base de datos, si remuevo los datos de una base de datos, será la salida de la consulta diferente?" Para poder probar esto, debemos construir lo que llamamos "bases de datos paralelas", que son bases de datos simples con una entrada removida.</p>
<p>En este primer ejemplo, crearemos una lista de todas las bases de datos paralelas a la que actualmente está contenida en la variable <code>db</code>. Luego crearemos una funcion que""</p>
<ul>
<li>Creará una base de datos inicial</li>
<li>Creará todas las bases de datos paralelas</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_parallel_db</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">remove_index</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">remove_index</span><span class="p">],</span> 
                      <span class="n">db</span><span class="p">[</span><span class="n">remove_index</span><span class="o">+</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_parallel_db</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4999])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_parallel_dbs</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="n">parallel_dbs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">db</span><span class="p">)):</span>
        <span class="n">pdb</span> <span class="o">=</span> <span class="n">get_parallel_db</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">parallel_dbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">parallel_dbs</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parallel_dbs</span> <span class="o">=</span> <span class="n">get_parallel_dbs</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">parallel_dbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>5000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">parallel_dbs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4999</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_db_and_parallels</span><span class="p">(</span><span class="n">num_entries</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
    <span class="n">parallel_dbs</span> <span class="o">=</span> <span class="n">get_parallel_dbs</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">parallel_dbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="p">,</span> <span class="n">pdbs</span> <span class="o">=</span> <span class="n">create_db_and_parallels</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([False,  True,  True,  True, False,  True,  True, False,  True, False])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdbs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([ True,  True,  True, False,  True,  True, False,  True, False]),
 tensor([False,  True,  True, False,  True,  True, False,  True, False]),
 tensor([False,  True,  True, False,  True,  True, False,  True, False]),
 tensor([False,  True,  True, False,  True,  True, False,  True, False]),
 tensor([False,  True,  True,  True,  True,  True, False,  True, False]),
 tensor([False,  True,  True,  True, False,  True, False,  True, False]),
 tensor([False,  True,  True,  True, False,  True, False,  True, False]),
 tensor([False,  True,  True,  True, False,  True,  True,  True, False]),
 tensor([False,  True,  True,  True, False,  True,  True, False, False]),
 tensor([False,  True,  True,  True, False,  True,  True, False,  True])]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Midiendo-la-privacidad-de-una-consulta">Midiendo la privacidad de una consulta<a class="anchor-link" href="#Midiendo-la-privacidad-de-una-consulta">&#182;</a></h1><p>Queremos ser capaces de consultar nuestra base de datos y evaluar si los resultados de una consulta está filtrando informacion privada. Esto se trata de evaluar si la salida de una consulta cambia cuando removemos a alguien de la base de datos. Específicamente queremos evaluar la máxima cantidad en la que una consulta cambia cuando alguien es removido (maximo sobre todas las posibles personas que pueden ser removidas. Para poder evaluar cuanta "privacidad se filtra" o pierde, vamos a iterar sobre cada persona en la base de datos y medir la diferencia entre la salida de la consulta relativa a cuando consultamos la base de datos completa.</p>
<p>A modo de ejemplo, acamos que nuestra primera "consulta" sea una suma, es decir, vamos a contar la cantidad de 1s que hay en la base de datos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="p">,</span> <span class="n">pdbs</span> <span class="o">=</span> <span class="n">create_db_and_parallels</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">full_db_result</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sensitivity</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pdb</span> <span class="ow">in</span> <span class="n">pdbs</span><span class="p">:</span>
    <span class="n">pdb_result</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
    <span class="n">db_distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pdb_result</span> <span class="o">-</span> <span class="n">full_db_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">db_distance</span> <span class="o">&gt;</span> <span class="n">sensitivity</span><span class="p">):</span>
        <span class="n">sensitivity</span> <span class="o">=</span> <span class="n">db_distance</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sensitivity</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sensitivity-o-L1-Sensitivity">Sensitivity o L1 Sensitivity<a class="anchor-link" href="#Sensitivity-o-L1-Sensitivity">&#182;</a></h2><p>Es el valor maximo en el que una consulta cambia cuando removemos un individuo del dataset</p>
<h2 id="Definamos-una-funci&#243;n-para-medir-la-sensibilidad-de-cualquier-funcion">Definamos una funci&#243;n para medir la sensibilidad de cualquier funcion<a class="anchor-link" href="#Definamos-una-funci&#243;n-para-medir-la-sensibilidad-de-cualquier-funcion">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sensitivity</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">n_entries</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">db</span><span class="p">,</span> <span class="n">pdbs</span> <span class="o">=</span> <span class="n">create_db_and_parallels</span><span class="p">(</span><span class="n">n_entries</span><span class="p">)</span>
    <span class="n">sensitivity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">full_db_result</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pdb</span> <span class="ow">in</span> <span class="n">pdbs</span><span class="p">:</span>
        <span class="n">pdb_result</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
        <span class="n">db_distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pdb_result</span> <span class="o">-</span> <span class="n">full_db_result</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">db_distance</span> <span class="o">&gt;</span> <span class="n">sensitivity</span><span class="p">):</span>
            <span class="n">sensitivity</span> <span class="o">=</span> <span class="n">db_distance</span>
    
    <span class="k">return</span> <span class="n">sensitivity</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">sensitivity</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluemos la sensibilidad de la funcion de promedio</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">db</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sensitivity</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.0005)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculando-la-L1-Sensitivity-de-la-funci&#243;n-Threshold">Calculando la L1 Sensitivity de la funci&#243;n Threshold<a class="anchor-link" href="#Calculando-la-L1-Sensitivity-de-la-funci&#243;n-Threshold">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">threshold_func</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">threshodl</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">threshodl</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sensitivity</span><span class="p">(</span><span class="n">threshold_func</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">sen_f</span> <span class="o">=</span> <span class="n">sensitivity</span><span class="p">(</span><span class="n">threshold_func</span><span class="p">,</span> <span class="n">n_entries</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sen_f</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0
0
0
0
0
0
tensor(1.)
tensor(1.)
0
tensor(1.)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Differencing-Attack">Differencing Attack<a class="anchor-link" href="#Differencing-Attack">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">create_db_and_parallels</span><span class="p">(</span><span class="n">num_entries</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">pdb</span> <span class="o">=</span> <span class="n">get_parallel_db</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">full_db</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="n">tenth</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tenth</span> <span class="o">-</span> <span class="n">full_db</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">value</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>test
</pre>
</div>
</div>

</div>
</div>

</div>
</div>
 

